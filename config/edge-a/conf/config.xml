<?xml version="1.0" encoding="UTF-8"?>
<hivemq xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="config.xsd">

  <mqtt>
    <receive-maximum>
      <server-receive-maximum>20</server-receive-maximum>
    </receive-maximum>
    <queued-messages>
      <max-queue-size>5000</max-queue-size>
      <strategy>discard-oldest</strategy>
    </queued-messages>
  </mqtt>

  <mqtt-listeners>
    <tcp-listener>
      <port>1883</port>
      <bind-address>0.0.0.0</bind-address>
    </tcp-listener>
  </mqtt-listeners>

  <admin-api>
    <enabled>true</enabled>
    <listeners>
      <http-listener>
        <bind-address>0.0.0.0</bind-address>
        <port>8080</port>
      </http-listener>
    </listeners>
  </admin-api>

  <mqtt-bridges>
    <mqtt-bridge>
      <id>edge-a-to-b</id>

      <remote-broker>
        <host>toxiproxy</host>
        <port>8666</port>
        <mqtt>
          <client-id>edge-a-forwarder</client-id>
          <clean-start>false</clean-start>
          <session-expiry>3600</session-expiry>
          <keep-alive>60</keep-alive>
        </mqtt>
      </remote-broker>

      <forwarded-topics>
        <forwarded-topic>
          <filters>
            <mqtt-topic-filter>#</mqtt-topic-filter>
          </filters>
          <max-qos>1</max-qos>
        </forwarded-topic>
      </forwarded-topics>

      <loop-prevention>
        <enabled>true</enabled>
      </loop-prevention>
    </mqtt-bridge>
  </mqtt-bridges>

</hivemq>